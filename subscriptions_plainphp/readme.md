1. в migrations создал таблицу-очередь и добавил индексы на изначальную таблицу users
2. в комментариях пояснил некоторые решения и упомянул альтернативы

3. структура сервиса:
/config - конфиги
/helpers - всякие хелперы для работы с БД и консольными демонами
/console - консольные жобы
crontab - кронтаб

Консольные жобы следующие:

fill_notifications_queue - папка для предполагаемых наполнялок очередей нотификаций

fill_notifications_queue/subscription_ends.php - наполнялка очереди нотификаций конкретно под нашу задачу (кончающиеся подписки). Максимально легковесная, вычитала юзеров и сунула в очередь.

validate_notifications_queue.php - валидирует  емейлы вот этой вот дорогой функцией check_email. Многопоточная

send_from_queue.php - отрисовывает и отправляет нотификации с провалидированными емейлами. Тоже многопоточная

clean_queue.php - чистка отработанных сообщений из очереди с задержкой. Почему с задержкой - потому что все жо
бы я попытался сделать так, чтоб логика не сильно страдала, если жоба сдохла и быда перезапущена. 
И вот fill_notifications_queue чтоб повторно не добавить юзера в очередь смотрит на таблицу notifications_queue. Если чистить сразу после отправки, то юзер снова наполнится. Внутри кода тоже в коммента написал мысли и альтренативы
